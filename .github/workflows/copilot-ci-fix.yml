on:
  workflow_run:
    workflows: [CI] # add workflows here
    types: [completed]

jobs:
  ci-failure:
    runs-on: ubuntu-latest
    if: ${{ github.event.workflow_run.conclusion == 'failure' }}
    steps:
      - uses: actions/checkout@v5
      - uses: austenstone/copilot-cli@main
        with:
          github-token: ${{ secrets.COPILOT_TOKEN }}
          prompt: |
            The GitHub Actions workflow run failed.
            Please analyze the failure and suggest a fix.
            Create a pull request with the necessary changes.
            Include the error logs and any relevant information.

            ## Input Data
            ```json
            ${{ toJson(github.event) }}
            ```